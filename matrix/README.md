# Residue и Matrix

Этот документ описывает два основных шаблонных класса, реализованных в задаче:

1. `Residue<Modulus>` — кольцо вычетов по модулю `Modulus`.
2. `Matrix<Rows, Columns, Field>` (и его алиас `SquareMatrix<Size, Field>`) — матрица над произвольным полем.

Документация включает:
- Краткое описание назначения классов
- Шаблонные параметры и ограничения
- Описание публичного интерфейса: конструкторы, операторы, основные методы
- Примеры использования

---

## 1. Класс `Residue<Modulus>`

### Назначение
Шаблонный класс, моделирующий кольцо вычетов по модулю `Modulus`.
- Поддерживает операции сложения, вычитания, умножения.
- При простом `Modulus` (проверка в compile-time) доступно деление (обращение по модулю).

### Шаблонные параметры
- `size_t Modulus` — модуль, по которому берутся остатки. Должен быть > 1.

### Ограничения
- Попытка деления при составном `Modulus` приводит к `static_assert` на этапе компиляции.
- Преобразования между `int` и `Residue<Modulus>` — только явные.

### Публичный интерфейс

| Член класса / оператор                | Сигнатура                                       | Описание                                                 |
|---------------------------------------|-------------------------------------------------|----------------------------------------------------------|
| Конструктор от `ssize_t`              | `Residue(ssize_t x)`                            | Инициализирует элемент как `x mod Modulus` в [0, Modulus).|
| Конструктор по умолчанию              | `Residue()`                                     | По умолчанию — нулевой элемент (`0 mod Modulus`).        |
| Явное приведение к `int`             | `explicit operator int()`                       | Возвращает текущее значение остатка как `int`.           |
| `operator+=`                         | `Residue& operator+=(Residue const& other)`     | Сложение по модулю.                                       |
| `operator-=`                         | `Residue& operator-=(Residue const& other)`     | Вычитание по модулю.                                      |
| `operator*=`                         | `Residue& operator*=(Residue const& other)`     | Умножение по модулю.                                      |
| `operator/=`                         | `Residue& operator/=(Residue const& other)`     | Деление (только если `Modulus` — простое).                |
| Свободные операторы `+`, `-`, `*`, `/`| `friend Residue operator+(...)` и др.           | Арифметика возвращает новый `Residue`.                   |
| Операторы сравнения                  | `friend bool operator==(Residue, Residue)`      | Сравнение по значению остатка.                           |
| Ввод/вывод через потоки               | `friend istream& operator>>`, `friend ostream& operator<<` | Чтение/печать остатка.                   |

#### Пример использования
```cpp
using R7 = Residue<7>;
R7 a(3), b(5);
R7 c = a + b;       // c = 1 (8 mod 7)
R7 d = a * b;       // d = 1 (15 mod 7)
R7 e = a / b;       // e = 2 (3 * 5^{-1} mod 7)
int x = static_cast<int>(e);
````

---

## 2. Класс `Matrix<Rows, Columns, Field>`

### Назначение

Шаблонный класс для работы с матрицами размером `Rows × Columns` над полем `Field`. Поддерживает алгебраические операции, вычисление детерминанта, ранга, обратной матрицы и др.

### Шаблонные параметры

* `size_t Rows` — число строк.
* `size_t Columns` — число столбцов.
* `typename Field` — тип элементов (должен поддерживать арифметику поля). По умолчанию `Rational`.

### Алиас для квадратных матриц

```cpp
template<size_t Size, typename Field = Rational>
using SquareMatrix = Matrix<Size, Size, Field>;
```

### Конструкторы

* `Matrix()` — нулевая матрица.
* `Matrix(std::initializer_list<std::initializer_list<Field>> values)` — инициализация списком.

### Статический метод

| Метод         | Сигнатура                     | Описание                                                    |
| ------------- | ----------------------------- | ----------------------------------------------------------- |
| `unityMatrix` | `static Matrix unityMatrix()` | Возвращает единичную матрицу (только если `Rows==Columns`). |

### Операторы

| Оператор              | Сигнатура                                                    | Описание                                             |
| --------------------- | ------------------------------------------------------------ | ---------------------------------------------------- |
| `operator+=`          | `Matrix& operator+=(Matrix const& rhs)`                      | Поэлементное сложение (только одинаковых размеров).  |
| `operator-=`          | `Matrix& operator-=(Matrix const& rhs)`                      | Поэлементное вычитание.                              |
| `operator*=(Field)`   | `Matrix& operator*=(Field const& scalar)`                    | Умножение всех элементов на скаляр.                  |
| `operator*=(Matrix)`  | `Matrix& operator*=(Matrix const& rhs)`                      | Матричное умножение (только согласованных размеров). |
| `operator+`, `-`, `*` | Свободные версии операторов.                                 | Возвращают новую матрицу.                            |
| `operator==`          | `friend bool operator==(Matrix const&, Matrix const&)`       | Поэлементное сравнение.                              |
| `operator[](x,y)`     | `Field& operator[](size_t x, size_t y)` / `const Field& ...` | Доступ к элементу `[x][y]` (C++23 двойные скобки).   |

### Основные методы

| Метод          | Сигнатура                                                | Описание                                                        |
| -------------- | -------------------------------------------------------- | --------------------------------------------------------------- |
| `det()`        | `Field det() const`                                      | Вычисление детерминанта квадратной матрицы за O(N³).            |
| `transposed()` | `Matrix<Columns, Rows, Field> transposed() const`        | Транспонирование матрицы.                                       |
| `rank()`       | `size_t rank() const`                                    | Вычисление ранга за O(min(Rows,Columns)·Rows·Columns).          |
| `inverted()`   | `Matrix<Columns, Rows, Field> inverted() const`          | Возвращает обратную матрицу (для квадратной матрицы над полем). |
| `invert()`     | `void invert()`                                          | На месте обращает матрицу.                                      |
| `trace()`      | `Field trace() const`                                    | След квадратной матрицы.                                        |
| `getRow()`     | `std::array<Field, Columns> getRow(size_t row) const`    | Получить указанную строку.                                      |
| `getColumn()`  | `std::array<Field, Rows> getColumn(size_t column) const` | Получить указанный столбец.                                     |

### Детали реализации

* **Метод Гаусса**: Унифицирован для вычисления ранга, детерминанта и обратной матрицы.

  * Параметры шаблона `makeGauss<MakeInverse, CalcDet>` управляют режимом работы.
  * Детальное разложение за O(max(Rows,Columns)·Rows·Columns).
* **Compile-time проверки**:

  * `static_assert` для операций, требующих квадратности или совпадения размеров.

### Пример использования

```cpp
// Определяем матрицу 3×3 над полем вычетов по модулю 7
using R7 = Residue<7>;
SquareMatrix<3, R7> m = {{ {1,2,3}, {4,5,6}, {7,8,9} }};

// Единичная матрица
auto I = SquareMatrix<3, R7>::unityMatrix();

// Арифметика
auto sum = m + I;
auto prod = m * I;

// Детёрминант
R7 d = m.det();

// Обратная и транспонированная
auto inv = m.inverted();
auto t = m.transposed();

// Ранг и след
size_t r = m.rank();
R7 tr = m.trace();
```

---
